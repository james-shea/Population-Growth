#-------------------------------------------------------------------------------------------------------------------
# C997 9/20/2020
# James Shea
#-------------------------------------------------------------------------------------------------------------------
# Clear Memory
#-------------------------------------------------------------------------------------------------------------------
rm(list=ls())
sinkoutput <- FALSE
closeAllConnections()
#-------------------------------------------------------------------------------------------------------------------
# Set Working Directory (Which already contains data file gathered fron census)
#-------------------------------------------------------------------------------------------------------------------
setwd("D:/OneDrive/WGU/C997")
#-------------------------------------------------------------------------------------------------------------------
# Read Data File (Part B)
#-------------------------------------------------------------------------------------------------------------------
raw <- read.csv("raw.csv")
#-------------------------------------------------------------------------------------------------------------------
# Clean Data (Part B)
#-------------------------------------------------------------------------------------------------------------------
clean <- as.data.frame(raw[c(41), c(8:17)])
clean
#-------------------------------------------------------------------------------------------------------------------
# Save Data
#-------------------------------------------------------------------------------------------------------------------
population <- c(11539336, 11544663, 11548923, 11576684, 11602700, 11617527, 11634370, 11659650, 11676341, 11689100)
years <- c(2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)
#-------------------------------------------------------------------------------------------------------------------
# Create Regression Model (Part A)
#-------------------------------------------------------------------------------------------------------------------
regression_model = lm(population~years)
#-------------------------------------------------------------------------------------------------------------------
# Summary of Regression Model (Part C)
#-------------------------------------------------------------------------------------------------------------------
summary(regression_model)
#-------------------------------------------------------------------------------------------------------------------
# Create List of Years to Predict
#-------------------------------------------------------------------------------------------------------------------
future_years <- data.frame(years=c(2020, 2021, 2022, 2023, 2024))
#-------------------------------------------------------------------------------------------------------------------
#  Use Linear Regression Model to Predict Population in Future Years
#-------------------------------------------------------------------------------------------------------------------
estimated <- predict(regression_model, future_years)
#-------------------------------------------------------------------------------------------------------------------
# Show Predicted Population Values (Part D)
#-------------------------------------------------------------------------------------------------------------------
estimated
#-------------------------------------------------------------------------------------------------------------------
# Combine Population Data with Predicted Data
#-------------------------------------------------------------------------------------------------------------------
population_values <- c(population, estimated)
#-------------------------------------------------------------------------------------------------------------------
# Combine All Years Together
#-------------------------------------------------------------------------------------------------------------------
time <- c(years, 2020, 2021, 2022, 2023, 2024)
#-------------------------------------------------------------------------------------------------------------------
# Plot Past Data with Predicted Data
#-------------------------------------------------------------------------------------------------------------------
plot(time, population_values, xlab="Year", ylab="Population", main = "Regression Estimated Population by Year for Ohio", type = "b")